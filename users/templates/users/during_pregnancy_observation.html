{% extends 'home/base.html' %}

{% block content %}
<div class="back__button">
    <button type="button" onclick="history.back()" class="btn">Вернуться</button>
</div>

{% if user.doctor %}
<div class="cut_width">
    <div class="block__profile__docs">
        <div class="block__lines">
            <div class="lines__element btn same_btn">
                {% comment %} <a href="{% url 'portion-page' current_user.id 'pregnant_woman_monitoring' 'pregnant_woman_monitoring' %}">Наблюдения за беременной</a> {% endcomment %}
                <a href="{% url 'observation' current_user.id 'pregnant_woman_monitoring' %}">Наблюдения за беременной</a>
            </div>
        </div>
    </div>
    <div class="block__profile__docs">
        <div class="block__lines">
            <div class="lines__element btn same_btn">
                <a href="{% url 'portion-page' current_user.id 'examination_list' 'examination_list' %}">Лист обследования</a>
            </div>
        </div>
    </div>
    {% for key, name in keys_names %}
    <div class="block__profile__docs">
        <div class="block__lines">
            <div class="lines__element btn same_btn">
                <a href="{% url 'observation' current_user.id key %}">{{ name }}</a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
<div class="fields center_div">
    <div class="tabs" style="width: 700px">
    </div>
    {% for forms, exists in data %}
        {% if exists %}
            {% for form in forms %}
            <div class="outer_div">
                <div class="border_div">
                    {% for p in form %}
                    <div class="fields__input">
                        <div class="fields__input__label">
                            <strong>{{ p.label_tag }}</strong>
                        </div>
                        <div class="fields__input__field noborder">
                        {% if p.field.choices %}
                            {% for i in p.field.choices %}
                                {% if p.value == i.0 %}
                                    {% if not i.0 %}
                                        ---------
                                    {% else %}
                                        {{i.1}}
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        {% elif not p.value %}
                            ---------
                        {% elif p.value %}
                            {{ p.value }}
                        {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        {% endif %}
    {% endfor %}
</div>
<script type='text/javascript' defer>
    var fields = document.getElementsByClassName('fields')[0];
    var tabs = document.getElementsByClassName('tabs')[0];
    
    function make_tabs(name, count, fildsets) {
        let label = document.createElement('label');
        label.innerText = name;
        label.classList.add('tab-title');
        label.setAttribute('for', `${name}`);
        label.setAttribute('style', 'width: 100%');
        
        let input = document.createElement('input');
        input.setAttribute('type', `radio`);
        input.setAttribute('id', `${name}`);
        input.setAttribute('name', `tab-group`);
        
        let section = document.createElement('section');
        section.classList.add('tab-content', 'center_div');
        
        if (count > fildsets.length) count = fildsets.length;
        
        for(let i = 0; i < count; i++) {
            section.appendChild(fildsets[i]);
        }
        
        let div = document.createElement('div');
        div.setAttribute('class', 'tab');
        div.setAttribute('style', 'width: 100%');
        div.appendChild(input);
        div.appendChild(label);
        div.appendChild(section);
        tabs.appendChild(div);
    }
    
    let nodes_id = [
        ['Личные данные','date', 30000]
    ]
    
    var tabs_names = [
        ['Наблюдение во время настоящей беременности', 5]
    ]
    
    var fieldsets = [...document.querySelectorAll('.outer_div')];
    
    for (let [name, count] of tabs_names) {
        make_tabs(name, count, fieldsets.splice(0, count));
    }
    
    document.querySelector('input[id="Наблюдение во время настоящей беременности"]').setAttribute('checked', '');
</script>
{% endif %}

{% endblock %}