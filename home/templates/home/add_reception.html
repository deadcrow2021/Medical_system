{% extends 'home/base.html' %}


{% block content %}
<div class="back__button">
    {% comment %} <button type="button" onclick="history.back()" class="btn">Вернуться</button> {% endcomment %}
    <a href="{% url 'profile' profile_id %}">Вернуться</a>
</div>

<div class="center_div">
    <div>
        <h3>Планы посещений пациента</h3>
    </div>
    
    <div class="outer_div">
        <div class="border_div">
            <form action="" method="POST">
                {% csrf_token %}
                <div class="fields add_form">
                    {% for p in form %}
                    <div class="fields__input">
                        <div class="fields__input__label">
                            {{ p.label_tag }}
                        </div>
                        <div class="fields__input__field">
                            {{ p }}
                        </div>
                    </div>
                    {{ p.errors }}
                    {% endfor %}
                    {{ form.errors }}
                </div>
                <div class="submit-btn">
                    <button type="submit" class="btn">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
    
    {% if notes %}
    <div class="block__profile__disease border_div reception_page">
        <div class="block__lines">
            <div class="lines__element">
                <table class="table">
                    <thead>
                        <tr>
                            <th>{% if user.patient %}
                                Пациент
                                {% else %}
                                Доктор
                                {% endif %}
                            </th>
                            {% if user.is_superuser %}
                            <th>Пациент</th>
                            {% endif %}
                            <th>Дата</th>
                            <th>Медицинская организация</th>
                            <th>Специальность</th>
                            <th>Номер посещения специалиста</th>
                            <th>Кабинет</th>
                            <th>Посещено</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for note in notes %}
                        <tr>
                            <td>
                                {% if user.patient %}
                                    <p>{{ note.patient.get_full_name }}</p>
                                {% else %}
                                    <p>{{ note.doctor.get_full_name }}</p>
                                {% endif %}
                            </td>
                            {% if user.is_superuser %}
                            <td><p>{{ note.patient.get_full_name }}</p></td>
                            {% endif %}
                            <td><p class="">{{ note.date_meeting }}</p></td>
                            <td><p>{{ note.get_med_organization_display }}</p></td>
                            <td><p>{{ note.get_specialization_display }}</p></td>
                            <td><p>{{ note.visit_number }}</p></td>
                            <td><p>{{ note.cabinet }}</p></td>
                            <td><p>{% if note.status == True %}Да{% else %}Нет{% endif %}</p></td>
                            {% comment %} <td><p>{{ note.status }}</p></td> {% endcomment %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% else %}
        <h3>Посещения не назначены</h3>
    {% endif %}
</div>
{% endblock %}